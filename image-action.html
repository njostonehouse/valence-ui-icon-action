<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../vui-typography/typography.html">
<dom-module id="vui-image-action">
	<template>
		<style is="custom-style" include="vui-small-text">
			:host {
				display:inline-block;
			}

			:host ::content a {
				@apply(--vui-small-text);
				background-repeat: no-repeat;
				background-position: 0 50%;
				text-decoration: none;
				padding-top: var(--image-height-padding);
				padding-bottom: var(--image-height-padding);
				padding-left: var(--image-width-padding);
				vertical-align: middle;
			}

			:host-context([dir='rtl']) ::content a {
				background-position: 100% 50%;
				padding-left: 0;
				padding-right: var(--image-width-padding);
			}

			:host(:hover), :host(:focus) {
				cursor: pointer;
			}

			:host(:hover) ::content a, :host(:focus) ::content a {
				text-decoration: underline;
			}
		</style>

		<content/>

	</template>
	<script>
		Polymer({
			is: 'vui-image-action',
			properties: {
				image: String
			},
			attached: function() {
				var host = this;
				var action = Polymer.dom(host).firstChild;
				var image = document.createElement('img');
				image.src = this.image;

				action.style.backgroundImage = 'url(' + image.src + ')';

				image.onload = function(){
					var actionPadding = (image.clientHeight - action.offsetHeight)/2;

					host.updateStyles({
						'--image-height-padding': actionPadding < 0 ? 0 : actionPadding + "px",
						'--image-width-padding': (image.naturalWidth + 10) + 'px'
					});
				};
			}
		});
	</script>
</dom-module>

<dom-module id="vui-image-action-list">
	<template>
		<style>
			:host {
				list-style: none;
				white-space: nowrap;
			}

			:host ::content vui-image-action {
				display: inline-block;
				padding: 0.2rem 0.72rem 0.2rem 0.72rem;
				vertical-align: middle;
			}

			:host ::content vui-image-action:first-child {
				padding-left: 0;
			}

			:host ::content vui-image-action:last-child {
				padding-right: 0;
			}

			:host-context([dir='rtl']) ::content vui-image-action:first-child {
				padding-left: 0.72rem;
				padding-right: 0;
			}

			:host-context([dir='rtl']) ::content vui-image-action:last-child {
				padding-left: 0;
				padding-right: 0.72rem;
			}
		</style>

		<content/>

	</template>
	<script>
		Polymer({
			is: 'vui-image-action-list',
			ready: function() {
				Polymer.dom(this).setAttribute("role", "list");
				Polymer.dom(this).children.forEach( function(item) {
					item.setAttribute("role", "listitem");
				});
			}
		});
	</script>
</dom-module>
